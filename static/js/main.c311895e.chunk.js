(this["webpackJsonphusky-reporting"]=this["webpackJsonphusky-reporting"]||[]).push([[0],{12:function(e,t,a){e.exports=a(26)},17:function(e,t,a){},19:function(e,t,a){},26:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(10),c=a.n(l),u=(a(17),a(6)),s=a.n(u),o=a(7),i=a(5),m=(a(19),a(20),a(28)),d=a(29),h=a(30),E=a(32),p=a(33),f=a(34),b=a(31);var y=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(!1),u=Object(i.a)(c,2),y=u[0],k=u[1],g=Object(n.useState)(null),v=Object(i.a)(g,2),w=v[0],x=v[1],j=Object(n.useState)(null),S=Object(i.a)(j,2),O=S[0],_=S[1],P=Object(n.useState)(null),A=Object(i.a)(P,2),C=A[0],U=A[1],T=Object(n.useState)(20),q=Object(i.a)(T,2),I=q[0],z=q[1],N=Object(n.useState)({round:{cans:0,unique:0,surveys:0},total:{cans:0,unique:0,surveys:0}}),R=Object(i.a)(N,2),D=R[0],F=(R[1],function(){var e=Object(o.a)(s.a.mark((function e(){var t,n,r,l,c,u,o,i,m,d,h,E,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=a){e.next=3;break}return alert("Don't forget the token!"),e.abrupt("return");case 3:if(null!=w&&null!=O){e.next=6;break}return alert("Please select start and end date of round first"),e.abrupt("return");case 6:return k(!0),t=w+" 00:01:00,"+O+" 23:59:00",e.next=10,fetch("https://compo-api.huskypet.co.za/husky-microsite/items/entries?access_token="+a+"&sort=?&filter[created_on][between]="+t+"&limit="+I).catch((function(e){return alert("Unable to communicate with API")}));case 10:return n=e.sent,e.next=13,n.json();case 13:if(!(r=e.sent)){e.next=36;break}return l=r.data.map((function(e){return e.customer})).join(","),e.next=18,fetch("https://compo-api.huskypet.co.za/husky-microsite/items/consumers?access_token="+a+"&filter[id][in]="+l+"&limit="+I).catch((function(e){return alert("Unable to communicate with API")}));case 18:return c=e.sent,e.next=21,c.json();case 21:return u=e.sent,o=r.data.map((function(e){return e.receipt})).join(","),e.next=25,fetch("https://compo-api.huskypet.co.za/husky-microsite/files?access_token="+a+"&filter[id][in]="+o).catch((function(e){return alert("Unable to communicate with API")}));case 25:return i=e.sent,e.next=28,i.json();case 28:for(m=e.sent,console.log("Files:",m),d=[],h=0;h<u.data.length;h++)for(E=0;E<r.data.length;E++)if(u.data[h].id===r.data[E].customer)for(p=0;p<m.data.length;p++)m.data[p].id===r.data[E].receipt&&d.push({consumer:u.data[h],entry:r.data[E],receipt:m.data[p].data.full_url});console.log(d),U(d),e.next=37;break;case 36:U(null);case 37:k(!1);case 38:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),W=function(){var e=Object(o.a)(s.a.mark((function e(){var t,n,r,l,c,u,o,i,m,d,h,E;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=a){e.next=3;break}return alert("Don't forget the token!"),e.abrupt("return");case 3:if(null!=w&&null!=O){e.next=6;break}return alert("Please select start and end date of round first"),e.abrupt("return");case 6:return k(!0),t=D,n=w+" 00:01:00,"+O+" 23:59:00",r="2020-06-13 00:01:00,"+O+" 23:59:00",e.next=12,fetch("https://compo-api.huskypet.co.za/husky-microsite/items/survey?access_token="+a+"&filter[created_on][between]="+n+"&limit=-1").catch((function(e){return alert("Unable to communicate with API")}));case 12:return l=e.sent,e.next=15,fetch("https://compo-api.huskypet.co.za/husky-microsite/items/survey?access_token="+a+"&filter[created_on][between]="+r+"&limit=-1").catch((function(e){return alert("Unable to communicate with API")}));case 15:return c=e.sent,e.next=18,fetch("https://compo-api.huskypet.co.za/husky-microsite/items/entries?access_token="+a+"&filter[created_on][between]="+n+"&limit=-1").catch((function(e){return alert("Unable to communicate with API")}));case 18:return u=e.sent,e.next=21,fetch("https://compo-api.huskypet.co.za/husky-microsite/items/entries?access_token="+a+"&filter[created_on][between]="+r+"&limit=-1").catch((function(e){return alert("Unable to communicate with API")}));case 21:if(o=e.sent,!(l&&l.ok&&c&&c.ok&&u&&u.ok&&o&&o.ok)){e.next=43;break}return e.next=25,l.json();case 25:return i=e.sent,e.next=28,c.json();case 28:return m=e.sent,e.next=31,u.json();case 31:return d=e.sent,e.next=34,o.json();case 34:h=e.sent,t.round.surveys=i.data.length,t.total.surveys=m.data.length,t.round.cans=d.data.length,t.total.cans=h.data.length,E=d.data.map((function(e){return e.customer})),t.round.unique=Array.from(new Set(E)).length,E=h.data.map((function(e){return e.customer})),t.total.unique=Array.from(new Set(E)).length;case 43:k(!1);case 44:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"App"},r.a.createElement(m.a,null,r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(E.a.Prepend,null,r.a.createElement(E.a.Text,{id:"basic-addon3"},"Security token (ask Kurt):")),r.a.createElement(p.a,{id:"basic-url","aria-describedby":"basic-addon3",onChange:function(e){return l(e.target.value)}})))),r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement("p",null,"Select the first day this round starts and the last day of the round.",r.a.createElement("br",null),r.a.createElement("small",null,"(System will automatically select 00:01 and 23:59 from first/last)")))),r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(E.a.Prepend,null,r.a.createElement(E.a.Text,null,"First Day")),r.a.createElement(p.a,{onChange:function(e){return x(e.target.value)},type:"date"}))),r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(E.a.Prepend,null,r.a.createElement(E.a.Text,null,"Last Day")),r.a.createElement(p.a,{onChange:function(e){return _(e.target.value)},type:"date"}))),r.a.createElement(h.a,null,r.a.createElement(f.a,{block:!0,variant:"primary",onClick:function(){return W()}},"Refresh"))),r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement("hr",null))),r.a.createElement(d.a,null,r.a.createElement(h.a,null,y?r.a.createElement("p",null,"Loading..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Selected Round"),r.a.createElement(b.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Total Entries (Cans)"),r.a.createElement("th",null,"Round Unique Entries"),r.a.createElement("th",null,"Total Survey Results"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,D.round.cans),r.a.createElement("td",null,D.round.unique),r.a.createElement("td",null,D.round.surveys)))),r.a.createElement("p",null,"Since Start Until Round Close"),r.a.createElement(b.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Total Entries (Cans)"),r.a.createElement("th",null,"Unique Entries"),r.a.createElement("th",null,"Total Survey Results"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,D.total.cans),r.a.createElement("td",null,D.total.unique),r.a.createElement("td",null,D.total.surveys)))))))),r.a.createElement("hr",null),r.a.createElement(m.a,null,r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement("p",null,"The winners below are randomly selected from the week selected above."))),r.a.createElement(d.a,null,r.a.createElement(h.a,null,r.a.createElement(E.a,{className:"mb-3"},r.a.createElement(E.a.Prepend,null,r.a.createElement(E.a.Text,null,"No. Winners")),r.a.createElement(p.a,{value:I,onChange:function(e){return z(e.target.value)},type:"number"})),r.a.createElement(f.a,{onClick:function(){return F()}},"Select Winners"))),r.a.createElement(d.a,null,r.a.createElement("p",null,"\xa0")),r.a.createElement(d.a,null,y?r.a.createElement("p",null,"Loading..."):r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{style:{textAlign:"left"}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Email"),r.a.createElement("th",null,"Cell"),r.a.createElement("th",null,"Entry date"),r.a.createElement("th",null,"Receipt"))),r.a.createElement("tbody",null,C&&C.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.consumer.name_surname),r.a.createElement("td",null,e.consumer.email),r.a.createElement("td",null,e.consumer.mobile),r.a.createElement("td",null,e.entry.created_on),r.a.createElement("td",null,r.a.createElement("a",{href:e.receipt,target:"_blank"},"View")))}))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[12,1,2]]]);
//# sourceMappingURL=main.c311895e.chunk.js.map